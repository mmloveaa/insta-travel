"use strict";var app=angular.module("googApp",["ui.router"]);app.config(["$stateProvider","$urlRouterProvider",function(e,t){e.state("home",{url:"/",templateUrl:"/html/home.html",controller:"homeCtrl"}).state("login",{url:"/login",templateUrl:"/html/login.html",controller:"loginCtrl"}),t.otherwise("/")}]),app.run(["AuthService",function(e){e.init()}]);var app=angular.module("googApp");app.controller("homeCtrl",["$scope","AuthService","NavService","UserService","InstaService",function(e,t,o,n,r){function a(){var t={zoom:4,center:new google.maps.LatLng(40,-98),mapTypeId:google.maps.MapTypeId.TERRAIN};e.map=new google.maps.Map(document.getElementById("map"),t),e.markers=[];for(var o=new google.maps.InfoWindow,n=function(t){var n=new google.maps.Marker({map:e.map,position:new google.maps.LatLng(t.lat,t.lng),title:t.address});n.content='<div class="infoWindowContent"></div>',google.maps.event.addListener(n,"click",function(){o.setContent("<h2>"+n.title+"</h2>"+n.content),o.open(e.map,n)}),e.markers.push(n)},r=0;r<e.locations.length;r++)n(e.locations[r])}function i(){var t={zoom:4,center:new google.maps.LatLng(40,-98),mapTypeId:google.maps.MapTypeId.TERRAIN};e.map=new google.maps.Map(document.getElementById("map"),t);for(var o=new google.maps.InfoWindow,n=function(t){var n=new google.maps.Marker({map:e.map,position:new google.maps.LatLng(t.lat,t.lng),title:t.address});n.content='<img class="infoWindowContent" src=\''+t.image+"'></img>",google.maps.event.addListener(n,"click",function(){o.setContent("<h2>"+n.title+"</h2>"+n.content),o.open(e.map,n)}),e.markers.push(n)},r=0;r<e.instagram.length;r++)n(e.instagram[r])}e.$watch(function(){return n.locations},function(t){e.locations=t,a()}),e.$watch(function(){return r.instagram},function(t){e.instagram=t,i()}),e.$on("showWishes",function(e){a()}),e.openInfoWindow=function(e,t){e.preventDefault(),google.maps.event.trigger(t,"click")},e.openInfoWindow=function(e,t){e.preventDefault(),google.maps.event.trigger(t,"click")}}]);var app=angular.module("googApp");app.controller("loginCtrl",["$scope","$state","AuthService",function(e,t,o){e.login=function(e){o.login(e).then(function(e){t.go("home")},function(e){console.error("err: ",e)})},e.register=function(e){o.register(e).then(function(e){t.go("home")},function(e){console.error("err: ",e)})}}]);var app=angular.module("googApp");app.controller("navCtrl",["$scope","UserService","AuthService","NavService","InstaService",function(e,t,o,n,r){e.$watch(function(){return t.user},function(t){e.username=t.username,e.locations=t.locations}),e.$watch(function(){return r.instagram},function(t){e.instagram=t}),e.logout=function(){o.logout(),e.username=null,e.locations=null},e.getCoords=function(){n.getCoords(e.location.address)},e.removeLocation=function(e){n.removeLocation(e)},e.getPhotos=function(){n.getPhotos()},e.showWishes=function(){n.showWishes()}}]);var app=angular.module("googApp");app.service("AuthService",["$http","$state","UserService",function(e,t,o){this.logout=function(){e["delete"]("/users/authenticate").then(function(e){o.destroy(),t.go("home")})},this.register=function(t){return e.post("/users/register",t).then(function(e){return o.set(e.data),e.data},function(e){return console.error(e)})},this.login=function(t){return e.post("/users/authenticate",t).then(function(e){return o.set(e.data),e.data},function(e){return console.error(e)})},this.init=function(){return e.get("/users/profile").then(function(e){return o.set(e.data),e.data},function(e){return console.error(e)})}}]);var app=angular.module("googApp");app.service("InstaService",function(){this.set=function(e){this.instagram=e.map(function(e){if(e.location){var t={image:e.images.low_resolution.url,address:e.location.name,lat:e.location.latitude,lng:e.location.longitude,link:e.link};return t}}).filter(function(e){return e?e:void 0})},this.destroy=function(){this.instagram=null}});var app=angular.module("googApp");app.service("UserService",function(){this.set=function(e){this.locations=e.locations,this.username=e.username,this._id=e._id,this.user=e},this.destroy=function(){this.locations=null,this.username=null,this._id=null}});var app=angular.module("googApp");app.service("NavService",["$http","UserService","InstaService","$rootScope",function(e,t,o,n){this.getCoords=function(o){function n(){var n=new google.maps.Geocoder;n.geocode({address:o},function(o,n){if(n===google.maps.GeocoderStatus.OK){var r={address:o[0].formatted_address,lat:o[0].geometry.location.lat(),lng:o[0].geometry.location.lng()};return e.post("/users/locations",r).then(function(e){return t.set(e.data),e.data},function(e){console.error("err: ",e)})}alert("Geocode was not successful for the following reason: "+n)})}n()},this.removeLocation=function(o){e["delete"]("/users/locations/"+o.address).then(function(e){return t.set(e.data)},function(e){return console.error(e)})},this.getPhotos=function(){return e.get("/users/instagram").then(function(e){return o.set(e.data.data)},function(e){return console.error(e)})},this.showWishes=function(){n.$broadcast("showWishes")}}]);
//# sourceMappingURL=bundle.js.map
